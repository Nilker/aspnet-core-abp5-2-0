(function(){app.modals.MySettingsModal=function(){var i=abp.services.app.profile,r=null,n,t=null;this.init=function(u){var f,e;n=u;f=n.getModal();t=f.find("form[name=MySettingsModalForm]");t.validate();r=t.find("[name='Timezone']").val();e=f.find("#btnEnableGoogleAuthenticator");e.click(function(){i.updateGoogleAuthenticatorKey().done(function(n){f.find(".google-authenticator-enable").toggle();f.find("img").attr("src",n.qrCodeSetupImageUrl)}).always(function(){n.setBusy(!1)})})};this.save=function(){if(t.valid()){var u=t.serializeFormToObject();n.setBusy(!0);i.updateCurrentUserProfile(u).done(function(){$("#HeaderCurrentUserName").text(u.UserName);abp.notify.info(app.localize("SavedSuccessfully"));n.close();var i=t.find("[name='Timezone']").val();abp.clock.provider.supportsMultipleTimezone&&r!==i&&abp.message.info(app.localize("TimeZoneSettingChangedRefreshPageNotification")).done(function(){window.location.reload()})}).always(function(){n.setBusy(!1)})}}}})();